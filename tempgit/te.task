
Import domtools
Import encode_decode
Function Query_Sid(Para_BOX_Info)
    Dim URL_Query_sid
    Dim xml_info
    Dim xml_info_encoded
    Dim Content_Lenth
    Dim Post_Header
    Dim Recourse_Sid
    Dim Response_Body
    Dim TempList1

    URL_Query_sid = "http://10.209.199.74:8120/igisserver_osl/rest/generalSaveOrGet/generalGetPage"
    xml_info = '<request><query mc="'&Para_BOX_Info[4]&'" ids="" where="1=1 AND ZH_LABEL LIKE \'%'&Para_BOX_Info[1]&'%\'" returnfields="INT_ID,ZH_LABEL,STRUCTURE_ID"/></request>'
    xml_info_encoded = "pageNum=1&"&"xml="&Replace(encode_decode.str_encode(xml_info),"/","%2F",true)
    Content_Lenth = CStr(Len(xml_info_encoded))
    Post_Header = {"Host":"10.209.199.74:8120","Content-Type":"application/x-www-form-urlencoded","Content-Length": Content_Lenth}
    Response_Body = HttpSession.Request("POST",URL_Query_sid,{"params":{},"data":xml_info_encoded,"headers":Post_Header,"cookies":{},"timeout":60000,"allow_redirects":true,"verify":false})
    domtools.InitDom(Response_Body)
    TracePrint(Response_Body)
    TempList1 = domtools.xpath("//@v")
    traceprint(TempList1)
    Recourse_Sid =Math.Round(CNumber(TempList1[0]),0)
    Return Recourse_Sid
End Function


Query_Sid([0,"太原综改区石沟村村西1号一级GF0001",112.4755923,37.63000168,"guangfenxianxiang"])